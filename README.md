# hhplus-tdd-lecture

[항해플러스 2주차 특강 신청 서비스]

### **`Default 3`**

- 아키텍처 준수를 위한 애플리케이션 패키지 설계
- 특강 도메인 테이블 설계 (ERD) 및 목록/신청 등 기본 기능 구현
- 각 기능에 대한 **단위 테스트** 작성

> **사용자 회원가입/로그인 기능은 구현하지 않습니다.**
> 

### **`STEP 3`**

- 설계한 테이블에 대한 **ERD** 및 이유를 설명하는 **README** 작성
- 선착순 30명 이후의 신청자의 경우 실패하도록 개선
- 동시에 동일한 특강에 대해 40명이 신청했을 때, 30명만 성공하는 것을 검증하는 **통합 테스트** 작성

### **`STEP 4`**

- 같은 사용자가 동일한 특강에 대해 신청 성공하지 못하도록 개선
- 동일한 유저 정보로 같은 특강을 5번 신청했을 때, 1번만 성공하는 것을 검증하는 **통합 테스트** 작성

## API Specs

1️⃣ **(핵심)** 특강 신청 **API**

- 특정 userId 로 선착순으로 제공되는 특강을 신청하는 API 를 작성합니다.
- 동일한 신청자는 동일한 강의에 대해서 한 번의 수강 신청만 성공할 수 있습니다.
- 특강은 선착순 30명만 신청 가능합니다.
- 이미 신청자가 30명이 초과 되면 이후 신청자는 요청을 실패합니다.

**2️⃣ 특강 신청 가능 목록 API** 

- 날짜별로 현재 신청 가능한 특강 목록을 조회하는 API 를 작성합니다.
- 특강의 정원은 30명으로 고정이며, 사용자는 각 특강에 신청하기 전 목록을 조회해 볼 수 있어야 합니다.

3️⃣  **특강 신청 완료 목록 조회 API**

- 특정 userId 로 신청 완료된 특강 목록을 조회하는 API 를 작성합니다.
- 각 항목은 특강 ID 및 이름, 강연자 정보를 담고 있어야 합니다.


## ERD
---
<img src="https://github.com/user-attachments/assets/1095e042-563d-403b-97aa-0f7001bb32e9" width="100%">

1. Lecture(특강)
  * id : PK
  * title : 특강 이름
  * lecturer : 특강 발표자
  * lectureDt : 특강 날짜
2. LectureCapacity(특강 신청 정보)
  * id : PK
  * lectureId : 특강 FK
  * capacity : 특강 신청가능 최대 인원 수
  * currentCount : 현재 신청한 인원 수
3. Registration(특강 신청)
  * id : PK
  * lectureId : 특강 FK
  * studentId : 학생 ID
  * registrationDt : 특강 신청 날짜

### 연관관계
* Lecture (1) : LectureCapacity(1)
* Lecture (1) : Registration(N)

## ERD 설계 이유
* Lecture과 Registration를 분리함으로써 특강정보와 신청정보를 독립적으로 관리할 수 있다.
  * 예를들어, Registration에 상태값(신청 완료, 신청 취소)을 도입하는 경우의 확장성을 고려
  * 한명의 수강생이 여러번 동시에 중복 요청의 경우, 신청 테이블에 lectureId와 studentId 조합의 유니크 제약조건으로 중복신청을 방지할 수있다.
* Lecture과 LectureCapacity를 분리함으로써, 특강은 특강과 신청인원을 독립적으로 관리할 수 있다.
  * 강의 등록 시 LectureCapacity의 특정 Raw만 Lock을 함으로써, 동시에 다른 Raw 데이터의 접근을 가능하게 한다.
  * 자신이 신청한 내역에 대한 데이터를 조회시, Lecture 테이블의 데이터는 Lock이 되지 않음으로써 성능향상을 기대
